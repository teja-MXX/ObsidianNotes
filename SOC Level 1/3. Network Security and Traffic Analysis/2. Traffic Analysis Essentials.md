## 🔐 Network Security & Network Data

### 🎯 Core Concepts

- **Authentication** – Verifying identity.
- **Authorisation** – Granting access based on verified identity.
    
### 🧱 Three Base Control Levels

|Level|Description|
|---|---|
|**Physical**|Prevents unauthorized physical access (e.g., locks, secured rooms).|
|**Technical**|Prevents unauthorized access to data (e.g., tunnels, encryption).|
|**Administrative**|Policies, access levels, and authentication processes.|

### 🚦 Two Primary Approaches in Network Security

|Approach|Description|
|---|---|
|**Access Control**|Ensures only authenticated and authorised users/devices can access network resources.|
|**Threat Control**|Monitors and prevents malicious or anomalous activities.|

#### 🔑 Key Elements of Access Control

- **Firewall** – Filters incoming/outgoing traffic using predefined rules.
- **Network Access Control (NAC)** – Checks device compliance before granting access.
- **Identity & Access Management (IAM)** – Manages user identities and access rights.
- **Load Balancing** – Distributes network traffic evenly for optimal performance.
- **Network Segmentation** – Isolates network areas for better control and security.
- **VPN (Virtual Private Network)** – Encrypts communications between remote devices.
- **Zero Trust Model** – "Never trust, always verify" principle with minimal privilege access.
    
#### ⚠️ Key Elements of Threat Control

- **IDS/IPS** – Detects (IDS) and prevents (IPS) malicious traffic.
- **DLP (Data Loss Prevention)** – Blocks sensitive data from leaving the network.
- **Endpoint Protection** – Multi-layer security for devices (AV, DLP, encryption, etc.).
- **Cloud Security** – Protects online/cloud resources using encryption and access controls.
- **SIEM** – Aggregates logs and traffic for real-time threat analysis.
- **SOAR** – Automates response across tools and teams.
- **Network Traffic Analysis / NDR** – Examines traffic for anomalies or threats.
    
#### 🔄 Typical Network Security Operation Table

| Deployment            | Configuration     | Management           | Monitoring        | Maintenance            |
| --------------------- | ----------------- | -------------------- | ----------------- | ---------------------- |
| Device/software setup | Initial setup     | Access control       | Threat monitoring | Security updates       |
| Automation            | Security policies | Rule adjustments     | Log capture       | License/config updates |
| VPN/NAT setup         | Threat mitigation | User activity review | System monitoring | MSS management         |

### 🛡️ Managed Security Services (MSS)

When resources are limited, organizations outsource security tasks to **MSSPs (Managed Security Service Providers)**.

#### 📦 Common MSS Offerings

- **Penetration Testing** – Simulates attacks to test defenses.
- **Vulnerability Assessment** – Finds and evaluates weaknesses.
- **Incident Response** – Plan for identifying and eliminating threats.
- **Behavioral Analysis** – Creates traffic and behavior baselines to detect anomalies.
    
### 📖 Story: Securing a Growing Business

Imagine a mid-sized startup called **ByteTree**, growing fast but lacking a dedicated security team. One day, a developer clicks on a phishing email link. A malicious payload starts exfiltrating data.

Here's how ByteTree responds using network security layers:

1. **Firewall** detects and blocks the outbound data exfiltration.
2. **SIEM** raises an alert by detecting abnormal activity patterns.
3. **IAM logs** reveal the credentials were used in two unusual locations.
4. **VPN access** is disabled for the compromised account immediately.
5. **Incident Response team** (outsourced to an MSSP) steps in to isolate the endpoint.
6. The **MSSP conducts a vulnerability assessment**, identifying outdated software on the user's machine.
7. ByteTree deploys **Zero Trust policies**, ensuring access is limited even for internal employees.
8. They start using **SOAR** to automate responses for future similar threats.
    
**Outcome:** The attack is contained within hours, and ByteTree improves its long-term security by leveraging managed services and solid network controls.

---
## 📡 Traffic Analysis / Network Traffic Analysis

### 📌 What is Traffic Analysis?

Traffic Analysis is the process of **intercepting**, **monitoring**, and **analysing** network data and communication patterns to:

- Detect system health issues.
- Spot anomalies or suspicious activities.
- Support both **security operations** and **performance monitoring**.
    
### 🛠️ Operational vs Security Use-Cases

|Purpose|Description|
|---|---|
|**Operational**|Ensures system availability, performance monitoring, troubleshooting.|
|**Security**|Detects anomalies, intrusions, and malicious behavior on the network.|

### 🔍 Core Disciplines Using Traffic Analysis

|Discipline|Covered In Room|
|---|---|
|**Network Sniffing & Packet Analysis**|Wireshark|
|**Network Monitoring**|Zeek|
|**Intrusion Detection & Prevention**|Snort|
|**Network Forensics**|NetworkMiner|
|**Threat Hunting**|Brim|

### 📊 Two Key Techniques in Traffic Analysis

#### 🌀 Flow Analysis

- **Definition**: Statistical summary of network flows from devices (routers/switches).
- **Usage**: High-level view without packet-level inspection.
- **Advantage**: Easy to collect and analyze.
- **Challenge**: No deep insight into the packet contents or exact behavior.
    
#### 🧪 Packet Analysis (Deep Packet Inspection - DPI)

- **Definition**: In-depth inspection of actual packet data.
- **Usage**: Investigates payloads to identify malicious content.
- **Advantage**: Reveals root causes of incidents.
- **Challenge**: Time-consuming and requires technical expertise.
    
### ✅ Benefits of Traffic Analysis

- 🔎 **Full network visibility** — Understand who is talking to whom, how often, and when.
- 📈 **Asset tracking and behavior baselining** — Identify normal vs abnormal activity.
- 🚨 **Threat detection and response** — Real-time or retrospective detection of anomalies and attacks.
    
### ❓ Does Traffic Analysis Still Matter?

Despite:

- The **rise of endpoint detection tools**,
- The **increased use of encrypted traffic**, and
- The **shift to cloud computing**,
    
**Traffic Analysis remains critical** because:

- It provides **raw, ground-truth data**.
- Even encrypted/obfuscated traffic patterns reveal anomalies.
- Advanced attackers often try to **blend in with normal traffic** — making traffic analysis key to spotting them.
	 
### 🧠 Story: "The Coffee-Scented Breach"

It was 10:45 AM on a Tuesday, and Riya, a junior SOC analyst, had just taken her first sip of filter coffee when the **SIEM dashboard pinged** with a burst of alerts. It wasn’t anything loud — just a slight increase in outbound traffic from a user machine tagged as `HR-LTP-27`.

"Odd," she muttered. That host usually slept quietly during the mornings. She checked the **flow data** first — a simple NetFlow output showed persistent connections to an external IP in **Eastern Europe**. No user ever connected there.

She dove deeper — launching **Wireshark** and pulling packet captures. Now the magic began. Packet-level analysis revealed HTTP POST requests sending **encoded blobs** at regular intervals. No headers revealed a user agent. The **DNS queries** from the machine were strangely randomized too.

She tagged the session for **Threat Hunting**, pivoted to **Zeek logs**, and confirmed there were **no prior baseline behaviors** for this pattern. A quick search in the IOC feed matched the IP to a known **C2 server used by Lokibot** — a credential stealer.

Riya escalated.

The IR team jumped in. Within 20 minutes, they **isolated the endpoint**, retrieved the **dropper file** from attachments, and stopped the lateral movement just before it could reach the finance subnet.

Later, during the debrief, her manager said,

> "You didn’t need fancy EDR for this. You just **read the wires like a book**. That’s traffic analysis in its purest form."

Riya sipped her now cold coffee and smiled.  
She’d always been more of a **packet poet** anyway.