# 🔗 What is a Kill Chain in Cybersecurity?

## 📜 Origin of the Term "Kill Chain"
- Originally a **military concept**, a **Kill Chain** refers to the structure of an attack — identifying, targeting, engaging, and destroying the enemy.
- In **cybersecurity**, this concept was adapted to describe the **stages of a cyber attack**.

## 🧠 Cyber Kill Chain: Definition & Purpose

### ✅ Definition
A **Cyber Kill Chain** is a framework that breaks down the **methodology/path** attackers (such as hackers or APTs) use to:
- Approach,
- Intrude, and
- Exploit a target.

For instance:
> An attacker scanning for vulnerabilities, exploiting a web flaw, and escalating privileges — this sequence forms a **Kill Chain**.

### 🎯 Objective of Understanding the Kill Chain
- **Identify** how attackers operate at each stage.
- **Implement defenses** to stop the attack as early as possible.
- **Disrupt or break** the chain at any point to prevent full compromise.

By studying the **Kill Chain**, security professionals can:
- **Pre-emptively protect systems** by understanding attack paths.
- **Detect early warning signs** of an attack.
- **Interrupt attackers** before they achieve their goals.

## 🛡️ Defensive Strategy
Understanding the attacker’s **Kill Chain** allows organizations to:
- Harden each stage of their defenses.
- Deploy **layered security controls**.
- Respond more effectively during real-world incidents.

---
# 🧠 Threat Modelling in Cybersecurity

## 📌 Definition
Threat modelling is a **systematic process** aimed at **improving the security** of systems and applications by identifying:
- **What needs to be secured**
- **What the risks are**
- **How to mitigate those risks**

## 🧩 Key Steps in Threat Modelling

1. **Identify Critical Systems & Functions**
   - Determine **which systems/applications** are vital for normal operations.
   - Assess **what data** they store or process (e.g. personal info, payment data).

2. **Assess Vulnerabilities**
   - Identify **weaknesses** in each system or application.
   - Understand **how these could be exploited** by an attacker.

3. **Create a Remediation Plan**
   - Design and implement **security controls** to address vulnerabilities.
   - Prioritize remediation based on risk and impact.

4. **Establish Preventive Policies**
   - Implement **secure SDLC (Software Development Life Cycle)** practices.
   - Conduct **security training**, such as **phishing awareness** programs.
   - Enforce **regular patching and hardening** processes.

## 🛡️ Purpose & Importance
- Provides a **high-level overview** of an organization’s IT assets.
- Helps identify **attack surfaces** and plan **proactive defenses**.
- Reduces overall **risk exposure**.

## 🔍 Popular Threat Modelling Frameworks

| Framework  | Description                                                                                                                      |
| ---------- | -------------------------------------------------------------------------------------------------------------------------------- |
| **STRIDE** | Focuses on types of threats: Spoofing, Tampering, Repudiation, Information Disclosure, Denial of Service, Elevation of Privilege |
| **DREAD**  | Risk assessment model based on: Damage, Reproducibility, Exploitability, Affected Users, Discoverability                         |
| **CVSS**   | Common Vulnerability Scoring System - measures the **severity** of known vulnerabilities                                         |

## 🔗 Link with Unified Kill Chain (UKC)
The **Unified Kill Chain** encourages threat modelling by:
- Helping identify **attack surfaces**
- Mapping how **systems may be exploited**
- Supporting **defensive strategy building**

> 📚 For deeper understanding, explore the "Principles of Security" room on TryHackMe.

---
# 🧱 Paul Pols’ Unified Kill Chain (UKC)

## 📖 Overview
- Developed by **Paul Pols in 2017**, the **Unified Kill Chain (UKC)** is a **comprehensive framework** that maps out the full lifecycle of a cyber attack.
- It is designed to **complement**, not replace, other frameworks like:
  - 🔹 **Lockheed Martin’s Cyber Kill Chain**
  - 🔹 **MITRE ATT&CK Framework**

## 🎯 Purpose
- Provide a **modern**, **detailed**, and **flexible** approach to understanding cyber attacks.
- Improve detection, response, and **defensive strategies**.
- Address gaps in traditional frameworks, such as **insider threats** and **complex, multi-vector attacks**.

## 🔍 Key Characteristics
- **18 Phases** of attack—significantly more granular than other models.
- Emphasizes not just actions, but also the **attacker's motives**, goals, and paths.
- Includes both **technical exploits** and **social engineering tactics**.

![[Pasted image 20250509173000.png]]
## 🆚 UKC vs. Traditional Frameworks

| Feature | UKC | Lockheed Martin Kill Chain | MITRE ATT&CK |
|--------|-----|-----------------------------|---------------|
| Year Introduced | 2017 | 2011 | 2013 (public) |
| Phases | 18 | 7 | Many (tactic-technique pairs) |
| Focus | Full attack lifecycle, including motives and exfiltration | Perimeter defense and malware attacks | Real-world tactics, techniques, and procedures (TTPs) |
| Strengths | Modern, detailed, holistic | Simple and linear | Flexible, detailed, widely used in detection/response |
| Weaknesses | Can be complex to implement | Outdated for modern APTs | Lacks clear sequencing of attack phases |

## 🧠 Benefits of UKC
- ✅ **Detailed attack mapping** with 18 stages
- ✅ Covers both **technical and human** attack vectors
- ✅ Integrates well with **Threat Intelligence**
- ✅ Supports **Threat Modelling** and defensive architecture
- ✅ Helps anticipate **attacker goals** and next steps

> 📚 Upcoming sections will explore how these 18 phases are grouped for easier understanding.

---
## 🕵️ UKC Phase: Reconnaissance (MITRE Tactic TA0043)

### 📌 Description
Reconnaissance is the **initial phase** where an attacker gathers information about a target to inform later phases like weaponisation and exploitation.

### 🧰 Types of Reconnaissance
- **Passive**: Observing without direct interaction (e.g. WHOIS, Google, LinkedIn).
- **Active**: Probing the target directly (e.g. port scanning, DNS queries).

### 🔍 Objectives of Reconnaissance

- 🔧 **Identify Systems & Services**
  - Detect what technologies (e.g., web servers, databases) the target uses.
  - Aids in weapon selection and planning an exploit path.

- 👤 **Harvest Employee Information**
  - Locate employee names, roles, and contact info via OSINT or social media.
  - Sets up phishing and impersonation attacks.

- 🔐 **Search for Credentials**
  - Look for leaked or reused passwords via paste sites or data breaches.
  - Useful for brute force, credential stuffing, or privilege escalation.

- 🌐 **Map Network Topology**
  - Understand connected systems and how to move laterally within the environment.
  - Helps with pivoting and privilege escalation later.

> 🧠 **Insight**: Recon is not a one-time step — information gathered here supports multiple stages throughout the kill chain.

---
## 💣 UKC Phase: Weaponization (MITRE Tactic TA0001)

### 📌 Description
Weaponization is the phase where the adversary prepares the necessary infrastructure and tools to carry out an attack. This includes developing or customizing payloads, and setting up systems that will later be used to interact with the compromised target.

### 🧰 Key Activities

- 🖥️ **Set Up Command & Control (C2) Server**
  - Create a server to remotely control compromised hosts.
  - May use HTTP(S), DNS, or custom protocols to avoid detection.

- 🐚 **Configure Reverse Shell Listeners**
  - Prepare systems that listen for reverse connections from exploited systems.
  - Critical for gaining interactive access after initial compromise.

- 🧬 **Develop or Customize Payloads**
  - Create malware, shellcode, or phishing documents.
  - Often tailored to the target system's environment (e.g., OS, antivirus evasion).

- 📦 **Package Exploits**
  - Combine exploits with delivery mechanisms like documents, scripts, or installers.
  - Tools like Metasploit or Cobalt Strike may be used to streamline this.

> ⚙️ **Goal**: Be ready to execute the attack and maintain interaction with the target once access is gained.

---
## 🎭 UKC Phase: Social Engineering (MITRE Tactic TA0001)

### 📌 Description
Social Engineering involves manipulating individuals into performing actions or divulging confidential information that furthers the attacker’s objectives. It leverages psychological manipulation rather than purely technical methods.

### 🧠 Common Techniques

- 📧 **Phishing Attacks**
  - Sending emails with malicious attachments or links.
  - Can include spearphishing (targeted) or bulk phishing.

- 🌐 **Credential Harvesting**
  - Impersonating legitimate websites to trick users into entering credentials.
  - Often used in conjunction with phishing emails or fake login portals.

- 📞 **Phone-Based Impersonation**
  - Calling employees and pretending to be IT support or another trusted entity.
  - Goal: extract sensitive data, reset passwords, or gain remote access.

- 🛠️ **Physical Impersonation**
  - Visiting the site in person and posing as:
    - Utility workers
    - Delivery personnel
    - Maintenance staff
  - Goal: gain unauthorized physical access or plug in malicious devices.

> 🎯 **Goal**: Trick users into compromising security voluntarily or unknowingly to assist in the attack chain.

---
## 💥 UKC Phase: Exploitation (MITRE Tactic TA0002)

### 📌 Description
This phase describes how an attacker leverages weaknesses or vulnerabilities in a system to execute malicious code. Exploitation often follows successful delivery or social engineering and is critical for establishing an initial foothold.

### 🛠️ Common Exploitation Techniques

- 🐚 **Reverse Shell Execution**
  - Uploading a reverse shell via a vulnerable web app and executing it.
  - Opens a connection back to the attacker's system.

- 🌀 **Script Interference**
  - Manipulating trusted or automated scripts (e.g., cron jobs, startup scripts) to execute attacker-controlled code.

- 🌐 **Web Application Vulnerabilities**
  - Exploiting flaws like:
    - Remote Code Execution (RCE)
    - Command Injection
    - Local File Inclusion (LFI)
  - Allows attackers to execute arbitrary commands on the server.

> 🎯 **Goal**: Achieve code execution on the target system by abusing application, system, or configuration vulnerabilities.

---
## 🔐 UKC Phase: Persistence (MITRE Tactic TA0003)

### 📌 Description
This phase covers the techniques adversaries use to **maintain long-term access** to a compromised system. Persistence ensures that access is **retained across reboots, disconnections, or account changes**, allowing continued control.

### 🛠️ Common Persistence Techniques

- 🔁 **Creating a Malicious Service**
  - Installing a service that restarts on boot or runs periodically to reconnect to the attacker.

- 🌐 **Command & Control (C2) Registration**
  - Linking the compromised system to a C2 server so it can receive and execute remote commands persistently.

- 🎭 **Conditional Backdoors**
  - Placing backdoors that only activate under certain conditions:
    - e.g., reverse shell launches when an administrator logs in.

> 🎯 **Goal**: Ensure continued, stealthy access even if the attacker’s initial connection is lost or detected.

---
## 🛡️ UKC Phase: Defence Evasion (MITRE Tactic TA0005)

### 📌 Description
This phase outlines the methods adversaries use to **bypass or disable security controls** and detection mechanisms. It plays a crucial role in **remaining undetected** during an attack.

### 🛠️ Common Defence Evasion Techniques

- 🔥 **Bypassing Web Application or Network Firewalls**
  - Obfuscating payloads or tunneling traffic through allowed protocols (e.g., HTTPS, DNS).

- 🧼 **Disabling Anti-virus or EDR**
  - Modifying or killing security processes.
  - Deploying payloads that avoid signature-based detection.

- 👻 **Evading Intrusion Detection Systems (IDS)**
  - Using low-and-slow attack techniques.
  - Encrypting or encoding traffic to avoid pattern recognition.

> 🎯 **Goal**: Avoid detection and prolong access, making forensic analysis and real-time threat detection harder.

---
## 🛡️ UKC Phase: Defence Evasion (MITRE Tactic TA0005)

### 📖 Description
The **Defence Evasion** phase focuses on techniques used by adversaries to **evade detection and bypass security controls** implemented within the system or network.

These techniques are crucial for attackers to remain undetected while maintaining access to compromised systems.

### 🧪 Examples of Defence Evasion Techniques

- **Bypassing Web Application Firewalls**
- **Avoiding or disabling Network Firewalls**
- **Disabling or evading Anti-Virus solutions**
- **Evading Intrusion Detection Systems (IDS)**

### 🎯 Why This Phase Matters
- Helps in analyzing how the attacker was able to remain undetected.
- Provides **insight for defenders** to improve existing detection and prevention capabilities.

---
## 📡 UKC Phase: Command & Control (MITRE Tactic TA0011)

### 📖 Description
The **Command & Control (C2)** phase involves the adversary **establishing communication with the compromised system**, using the infrastructure set up during the **Weaponization** phase.

This phase allows the attacker to interact with the infected host and issue commands remotely.

### 🧪 Examples of C2 Actions

- 📥 **Executing remote commands** on the victim machine
- 🔐 **Exfiltrating data**, including credentials and sensitive files
- 🔁 **Pivoting to other systems** within the network

### 🧠 Key Insight
This phase enables full remote control of the system and is **critical to achieving the attacker's end goals**. Monitoring and detecting C2 traffic is crucial to identifying active compromises.

---
## 🔄 UKC Phase: Pivoting (MITRE Tactic TA0008)

### 📖 Description
**Pivoting** is the technique used by an adversary to move from a **compromised system to other internal systems** that are not directly accessible from the internet.

The attacker uses the compromised system as a **stepping stone** to reach deeper into the network, targeting internal systems that may hold sensitive data or weaker security.

### 🧪 Example Scenario
- The attacker gains access to a **public-facing web server**.
- From this foothold, they pivot to **internal servers**, such as:
  - File servers
  - Domain controllers
  - Database systems

### 🧠 Key Insight
Pivoting is a critical phase for attackers to **expand their control** inside a network. It emphasizes the importance of **internal network segmentation** and **monitoring lateral movement** to contain breaches.

---
## 🔄 UKC Phase: Pivoting (MITRE Tactic TA0008)

### 📖 Description
After gaining access to a system, the adversary uses it as a **staging site** to:
- Act as a **bridge (pivot)** between their external infrastructure and the internal victim network.
- Distribute malware, backdoors, or other payloads to additional systems.
- Facilitate **lateral movement** to systems that are not directly reachable from the internet.

### 🧪 Example
- The attacker compromises a public-facing web server.
- From there, they route traffic through it to explore and attack internal hosts.

---
## 🔍 UKC Phase: Discovery (MITRE Tactic TA0007)

### 📖 Description
In the **Discovery** phase, adversaries gather detailed information about the target environment. This includes identifying:
- Active user accounts and their privileges.
- Running processes and installed applications.
- Network connections and topology.
- Shared files, directories, and drives.
- System configurations and hostnames.
- Web browser history and activity.

This intelligence supports **lateral movement**, **privilege escalation**, and **data exfiltration** in later phases.

### 🧠 Key Insight
Discovery builds a **knowledge base** for the attacker to make informed decisions about their next steps, helping them navigate and exploit the internal network more effectively.

---
## ⬆️ UKC Phase: Privilege Escalation (MITRE Tactic TA0004)

### 📖 Description
After gathering sufficient information during the Discovery phase, the adversary attempts to **gain elevated privileges** on the compromised system. This helps them:
- Execute more powerful commands.
- Disable security tools.
- Move laterally across systems.
- Access sensitive data.

### 🎯 Common Escalation Targets
- **SYSTEM / ROOT** — Full control over the operating system.
- **Local Administrator** — High-level access on a single machine.
- **Admin-like User Accounts** — Users with elevated rights due to role or misconfiguration.
- **Special-purpose Accounts** — Users with access to key applications, backups, or databases.

### ⚙️ Techniques Used
- Exploiting known or zero-day **vulnerabilities**.
- Abusing **misconfigurations** or poor access control.
- Dumping and cracking **hashed credentials**.
- Exploiting **service misconfigurations**, like weak permissions or insecure token handling.

---

## 💥 UKC Phase: Execution (MITRE Tactic TA0002)

### 📖 Description
The attacker now executes malicious code or scripts on the compromised system. This is typically done using the pivot system, which acts as a host for:
- Remote Access Trojans (RATs)
- Command & Control (C2) scripts
- Malicious payloads or executables
- Scheduled tasks or cron jobs to maintain access

This phase ensures **persistent access** and enables further stages of the attack.

---

## 🧠 UKC Phase: Credential Access (MITRE Tactic TA0006)

### 📖 Description
The attacker now aims to harvest **valid credentials** to escalate privileges and blend into the environment. This step strengthens their foothold by allowing them to impersonate legitimate users.

### 🔍 Techniques
- **Keylogging**
- **Credential dumping** (e.g., using Mimikatz, LSASS memory)
- **Brute force or spraying attacks**
- **Sniffing network traffic**
- **Grabbing saved credentials** from browsers or apps

These credentials make detection significantly harder.

---

## 🔄 UKC Phase: Lateral Movement (MITRE Tactic TA0008)

### 📖 Description
With valid credentials and elevated privileges, the adversary moves laterally within the network to reach additional systems that are closer to their **ultimate objective** (e.g., data exfiltration or domain admin access).

### 🎯 Goals
- Compromise additional hosts
- Reach critical assets (e.g., file servers, databases)
- Use stealthy tools to avoid detection (e.g., PsExec, RDP, WMI)

This phase often leads to widespread compromise if undetected.

---
## 📦 UKC Phase: Collection (MITRE Tactic TA0009)

### 📖 Description
Now that access is established and elevated, the attacker begins gathering **valuable data** from compromised systems.

### 🎯 Target Sources
- Drives and filesystem
- Web browsers (saved credentials, sessions)
- Audio and video files
- Email communications and attachments

This compromises **data confidentiality** and sets the stage for exfiltration.

---

## 📤 UKC Phase: Exfiltration (MITRE Tactic TA0010)

### 📖 Description
The adversary now **steals the collected data**, often encrypting and compressing it to evade detection.

### 🛠 Methods
- Use of the C2 channel for covert data transfer
- Data fragmentation and slow exfiltration to avoid alerts
- Leveraging encrypted tunnels or HTTPS to blend in

This phase marks a **critical data breach event**.

---

## 💣 UKC Phase: Impact (MITRE Tactic TA0040)

### 📖 Description
The attacker now causes damage to the **integrity or availability** of data/systems. The intent is often disruptive or destructive.

### ⚠️ Potential Impacts
- Disk wiping or system corruption
- Data encryption (e.g. ransomware)
- Account lockouts or access removal
- Website defacement
- Denial of Service (DoS) attacks

---
## 🎯 Final Phase: Objectives

### 📖 Description
With control and access, the attacker seeks to **achieve their core strategic goal**.

### 💰 Examples of Objectives
- Financial gain via **ransomware or extortion**
- Reputational damage through **data leaks**
- Political or ideological impact (e.g., hacktivism)
- Competitive advantage via **intellectual property theft**
---
