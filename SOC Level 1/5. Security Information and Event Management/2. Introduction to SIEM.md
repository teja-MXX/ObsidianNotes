# 📘 SIEM & Log Visibility: Why It Matters

## 🔍 Why Do We Need Network Visibility?

A network typically contains:

- Multiple **Windows/Linux endpoints**
- A **web server**
- A **data server**
- A **router** for internet access
    

Each of these components **generates logs**, which are crucial for:
- Detecting malicious behavior
- Troubleshooting system errors
- Conducting forensic investigations
    
## 🧭 Categories of Logs

### 🖥️ 1. Host-Centric Log Sources

These are **logs from within an individual host (endpoint)**.

📄 **Examples:**

- Windows Event Logs
- Sysmon logs
- Osquery logs
    
🔍 **Event Types:**

- File access (e.g., a user opens `data.docx`)
- Authentication attempts (success/failure)
- Process creation (e.g., `powershell.exe`)
- Registry key changes
- PowerShell script execution
    
### 🌐 2. Network-Centric Log Sources

These relate to **communication between systems** or with the internet.

📄 **Examples:**

- SSH connections
- VPN traffic
- HTTP/HTTPS requests
- FTP access
- SMB/Network file sharing
    

🔍 **Event Types:**

- User connected via VPN to access internal files
- Uploads via FTP
- Suspicious browsing behavior
    
## 🛡️ Why SIEM Is Essential

Without SIEM, you'd be:

- Manually checking logs on each device
- Missing correlations between hosts & networks
- Responding slower to attacks
    

## ✅ SIEM Capabilities

|Feature|Description|
|---|---|
|📥 **Log Ingestion**|Real-time intake from diverse sources (Windows, Linux, firewalls, etc.)|
|🚨 **Alerting**|Notifies on predefined anomalies (e.g., failed logins, port scans)|
|👀 **24/7 Monitoring**|Ensures continuous visibility across all systems|
|🧠 **Threat Detection**|Detects known attack patterns (via correlation rules or threat intel)|
|📊 **Visualization & Reports**|Graphs and dashboards for easy SOC analysis|
|🕵️ **Incident Investigation**|Look back at logs and timelines to trace the attacker’s activity|

## 🧠 Real-World Story: “The Curious VPN User”

A SOC analyst named **Neha** was on a routine shift monitoring alerts from the SIEM. She noticed a spike in **VPN logins** from a user account outside normal working hours.

🔍 **Log Events in SIEM:**

- Multiple login attempts → **VPN log (network log)**
- Success at 2:14 AM → **Suspicious**
- Access to sensitive folder `\\fileserver\R&D\2026-plans` → **Windows File Share log**
- Downloaded 14 files → **Host-centric logs showed file access**
- Ran an unknown executable → **Sysmon log showed `research_tool.exe`**
    
⏱️ **Timeline correlation** in SIEM made it clear this was a possible insider threat or compromised credentials.

🔒 The SOC escalated to IR (Incident Response). Investigation revealed:

- The user’s credentials had been phished
- Threat actor had been inside for 3 days
    
**Resolution:** Passwords reset, machine isolated, indicators of compromise shared across SIEM.

## 📝 Summary

SIEM acts as the **central brain** for:
- Ingesting all logs in real-time
- Correlating data from host and network
- Detecting, visualizing, and responding to threats
    
Without SIEM:
- Analysts miss the forest for the trees
- Visibility gaps increase risk exposure
    
With SIEM:
- Security teams go from reactive to **proactive defense**.

---
# 📚 Log Sources & Ingestion in a SIEM Environment

## 🔍 What Are Logs?

Logs are **records of system activities** generated by devices and services in a network. They provide visibility into user actions, errors, system changes, network access, and more.

> 🛡️ Logs form the **backbone of threat detection, forensic investigations, and compliance audits**.

## 💻 Common Devices & Their Logs

### 🪟 **Windows Machines**

Windows records nearly **every system activity** in the **Event Viewer**.
#### 🔑 Key Points:

- Each event is assigned a **unique Event ID**.
- Logs include:
    - Login events
    - Process creation
    - File access
    - System errors    
- View logs: `Start > Search > Event Viewer`
    

📂 **Example Log Categories**:

- **System** (device drivers, OS changes)
- **Security** (logins/logoffs, audit logs)
- **Application** (installed software logs)
- **PowerShell Operational** (scripts and commands run)
    
✅ Forward these logs to a **SIEM** to correlate across endpoints.

### 🐧 **Linux Workstations**

Linux systems store logs in **/var/log/**.
#### 📄 Common Log Files:

| File Path                        | Description                         |
| -------------------------------- | ----------------------------------- |
| `/var/log/httpd` or `/apache`    | Apache request/response, error logs |
| `/var/log/cron`                  | Cron job activity                   |
| `/var/log/auth.log` or `/secure` | Login attempts, SSH access          |
| `/var/log/kern`                  | Kernel-related events               |

📘 **Sample cron log**:
```pgsql
May 28 13:04:20 ebr crond[2843]: no timestamp found (user root job sys-daily)
```

## 🌐 **Web Servers (Apache Example)**

Track HTTP/S requests/responses to detect:
- Web shells
- SQLi
- Command injection
- Reconnaissance (e.g., `curl`, `nmap`, etc.)
    
📘 **Sample Apache log**:
```apache.log
192.168.21.200 - - [21/Mar/2022:10:17:10] "GET /cgi-bin/try/ HTTP/1.0" 200 3395
```
## 🧲 Log Ingestion into SIEM

Once logs are generated, they need to be **ingested by the SIEM** for analysis.

### 🚀 Common Log Ingestion Methods
#### 1. **Agent / Forwarder**

- Lightweight tool installed on endpoints.
- Monitors log directories, config files, Windows Event Logs.
- Example: **Splunk Universal Forwarder**
    
📥 **Use Case**: Real-time collection from hundreds of endpoints.

#### 2. **Syslog**

- A **standard protocol** used widely in Linux/Unix systems.
- Sends logs from services like SSH, FTP, Apache, etc., to SIEM.
📥 **Use Case**: Consolidate logs from _firewalls, routers, Linux servers_.

#### 3. **Manual Upload**

- Used for **offline analysis**.
- Logs (in `.log`, `.csv`, `.json`, etc.) are manually uploaded to SIEM.
- Useful for forensic investigations and threat emulation labs.
🧪 **Tools**: Splunk, ELK, Graylog

#### 4. **Port Forwarding**

- SIEM listens on specific **TCP/UDP ports** (e.g., 514 for syslog).
- Devices push logs directly to these ports.
📥 **Use Case**: Quick integration for devices that can’t run agents.

### 🔍 Example: Splunk Ingestion Methods

|Method|Description|
|---|---|
|Agent|Real-time collection from endpoints|
|Syslog|Log forwarding from network appliances|
|Manual Upload|Upload `.evtx`, `.csv`, `.json`, etc.|
|Port Listener|Directly ingest logs pushed via network|
## 🧠 Summary

|System|Log Source|Log Location / Method|
|---|---|---|
|**Windows**|Event Viewer|Forwarder agent (e.g., Splunk UF)|
|**Linux**|`/var/log/` files|Syslog, agent, or port-based ingestion|
|**Web Server**|Apache/Nginx access/error logs|`/var/log/httpd` or `/var/log/apache2/`|
|**SIEM**|Aggregates, normalizes, correlates all logs|Real-time monitoring and alerting|

> 📌 **Log correlation across hosts, apps, and the network gives true visibility and enables early threat detection.**

---
# 🔐 SIEM & SOC Analyst Responsibilities

## 📊 What is SIEM?

**SIEM (Security Information and Event Management)** is a centralized solution for:
- **Collecting** logs from various sources (hosts, networks, applications, etc.) 
- **Correlating** events to detect suspicious patterns
- **Alerting** when a rule is triggered or a threshold is crossed
- **Providing visibility** into both host-centric and network-centric activities

## 🧠 Why SIEM Matters in Cybersecurity

SIEM acts as the **brain of the SOC**, helping analysts detect and respond to security threats in real time.

### 🔍 SIEM Capabilities:

|Capability|Description|
|---|---|
|🔄 **Correlation**|Matches patterns across multiple sources (e.g., login + data access)|
|👁️‍🗨️ **Network & Host Visibility**|Tracks endpoint and communication behaviors|
|🚨 **Alerting**|Notifies analysts of potential threats based on rules/thresholds|
|🕵️‍♂️ **Threat Hunting Support**|Enables manual investigation beyond rule-based alerts|
|📉 **Noise Reduction**|Helps tune out false positives and prioritize critical events|
|📁 **Historical Analysis**|Stores past logs for forensic investigations and compliance reports|

> ✅ SIEM is essential to **detect threats early** and **respond quickly** to limit damage.

## 🧑‍💻 SOC Analyst Responsibilities

Security Operations Center (SOC) analysts rely heavily on SIEM tools for monitoring and analysis.
### 🎯 Core Responsibilities:

| Task                              | Description                                                           |
| --------------------------------- | --------------------------------------------------------------------- |
| 📡 **Monitoring**                 | Continuously observe security alerts and logs from across the network |
| 🔎 **Investigating Alerts**       | Analyze alerts to determine legitimacy and severity                   |
| ❌ **Identifying False Positives** | Spot non-malicious events mistakenly flagged as threats               |
| 🛠️ **Tuning SIEM Rules**         | Refine alert logic to reduce noise and improve detection accuracy     |
| 📋 **Reporting & Compliance**     | Generate reports for audits and management                            |
| 🕳️ **Covering Blind Spots**      | Identify missing log sources or unmonitored activity                  |

## 🧠 Analyst Tip: Think Like an Adversary

- Understand attacker **TTPs (Tactics, Techniques, Procedures)** from sources like MITRE ATT&CK.
- Use that knowledge to improve detection rules and hunting hypotheses.
- Keep tuning, iterating, and questioning what’s _not_ visible.
    
## 🧰 Tools Analysts Use with SIEM:

- 📈 **Dashboards** – For real-time visibility
- 🔎 **Search Queries (KQL, Lucene, etc.)** – For investigations
- 🧮 **Correlation Rules / Detection Logic** – For alerting
- 💬 **Case Management / Ticketing Tools** – For tracking response steps

## 🚨 Real-Life SIEM Use Case

> 📌 **Scenario**: A SIEM receives logs showing a user authenticating from two countries within 5 minutes.

- 🔁 The SIEM correlates **geolocation** + **logon event** + **IP data**
- 🧠 Rule triggers a potential “**Impossible Travel**” alert
- 🕵️‍♂️ SOC Analyst investigates: confirms it’s compromised credentials
- ⚙️ Response initiated: password reset, session kill, endpoint isolation

---

# 📊 SIEM Rules, Dashboards & Alert Investigation

## 🧩 SIEM Log Ingestion

SIEM tools collect **security-related logs** through:

- 📦 **Agents/Forwarders** (e.g., Splunk Universal Forwarder)
- 🔌 **Port Forwarding**
- 🖥️ **Manual Uploads**
- 📡 **Syslog Protocol**
    
Once logs are **ingested and normalized**, correlation rules scan for **unwanted behavior or suspicious patterns**. If matched, an **alert is triggered**.

## 📈 SIEM Dashboards

Dashboards present **actionable insights** from raw event data in a visual format.
### ✅ Typical Dashboard Widgets:

- 🚨 **Alert Highlights**
- ⚙️ **System Notifications**
- ❤️ **Health/Heartbeat Status**
- 👤 **Failed Login Attempts**
- 📊 **Total Events Ingested**
- 🔁 **Rules Triggered**
- 🌐 **Top Domains Visited**
    
> 🧠 Custom dashboards can be created based on role (SOC Level 1, Threat Hunter, etc.).

### 📷 Example: _QRadar Default Dashboard_

- Quick overview of recent alerts, system health, and log volume
- Rule triggers visualized over time
- Geolocation of inbound/outbound connections
    
## ⚖️ Correlation Rules

**Correlation rules** are logical conditions to detect suspicious behavior based on field-value pairs in logs.

### 🔄 Common Rule Examples:

| Rule Scenario             | Condition                                                       |
| ------------------------- | --------------------------------------------------------------- |
| 🔑 Multiple Failed Logins | If user fails login **5 times in 10 seconds**, raise alert      |
| ✅ Success After Failures  | If login is successful **after multiple failures**, raise alert |
| 💾 USB Usage Detection    | If **USB device plugged**, trigger alert (if restricted)        |
| 📤 Data Exfiltration      | If **outbound traffic > 25MB**, trigger alert                   |

## 🧪 Sample Use Cases

### 🧹 Use Case 1: Event Log Cleared

- **Tactic**: Adversary clears logs to hide tracks
- **Event ID**: `104` (Windows Event Log cleared)
    
```txt
IF LogSource = WinEventLog AND EventID = 104 THEN Alert = "Event Log Cleared"
```

### 🧍 Use Case 2: Suspicious Command (whoami)

- **Tactic**: Adversary checks current privileges
- **Event ID**: `4688` (Process Creation)
- **Field to monitor**: `NewProcessName`


```txt
IF LogSource = WinEventLog AND EventID = 4688 AND NewProcessName CONTAINS "whoami" THEN Alert = "WHOAMI Command Detected"
```

> 🔍 Other sensitive command examples: `net user`, `ipconfig`, `powershell`, `cmd.exe`


## 🕵️ Alert Investigation Workflow

Once a rule is triggered, the **SOC Analyst** takes the following steps:

1. 📥 **Review Alert** on dashboard (source IP, user, command, etc.)
2. 🧮 **Analyze Rule Conditions** – Which field-value pairs matched?
3. 🔍 **Classify Alert**:
    - **False Positive** → Tune rule (e.g., suppress known-good activity)
    - **True Positive** → Begin deeper investigation
4. 🧑‍💻 **Actions Taken**:
    - Contact endpoint/asset owner
    - Correlate with other logs or PCAPs
    - Confirm malicious intent
5. 🚨 **Respond**:
    - Isolate infected machine
    - Block malicious IP/domain
    - Trigger IR process (if needed)
        
## 🧠 Key Takeaways

- Rules depend on **normalized logs** with consistent fields.
- Dashboards help prioritize alerts visually.
- Rules can evolve – **tuning is essential**.
- Not every alert is malicious — **context matters**.

---

