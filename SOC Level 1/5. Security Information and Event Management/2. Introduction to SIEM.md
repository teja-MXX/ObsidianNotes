# ğŸ“˜ SIEM & Log Visibility: Why It Matters

## ğŸ” Why Do We Need Network Visibility?

A network typically contains:

- Multiple **Windows/Linux endpoints**
- A **web server**
- A **data server**
- A **router** for internet access
    

Each of these components **generates logs**, which are crucial for:
- Detecting malicious behavior
- Troubleshooting system errors
- Conducting forensic investigations
    
## ğŸ§­ Categories of Logs

### ğŸ–¥ï¸ 1. Host-Centric Log Sources

These are **logs from within an individual host (endpoint)**.

ğŸ“„ **Examples:**

- Windows Event Logs
- Sysmon logs
- Osquery logs
    
ğŸ” **Event Types:**

- File access (e.g., a user opens `data.docx`)
- Authentication attempts (success/failure)
- Process creation (e.g., `powershell.exe`)
- Registry key changes
- PowerShell script execution
    
### ğŸŒ 2. Network-Centric Log Sources

These relate to **communication between systems** or with the internet.

ğŸ“„ **Examples:**

- SSH connections
- VPN traffic
- HTTP/HTTPS requests
- FTP access
- SMB/Network file sharing
    

ğŸ” **Event Types:**

- User connected via VPN to access internal files
- Uploads via FTP
- Suspicious browsing behavior
    
## ğŸ›¡ï¸ Why SIEM Is Essential

Without SIEM, you'd be:

- Manually checking logs on each device
- Missing correlations between hosts & networks
- Responding slower to attacks
    

## âœ… SIEM Capabilities

|Feature|Description|
|---|---|
|ğŸ“¥ **Log Ingestion**|Real-time intake from diverse sources (Windows, Linux, firewalls, etc.)|
|ğŸš¨ **Alerting**|Notifies on predefined anomalies (e.g., failed logins, port scans)|
|ğŸ‘€ **24/7 Monitoring**|Ensures continuous visibility across all systems|
|ğŸ§  **Threat Detection**|Detects known attack patterns (via correlation rules or threat intel)|
|ğŸ“Š **Visualization & Reports**|Graphs and dashboards for easy SOC analysis|
|ğŸ•µï¸ **Incident Investigation**|Look back at logs and timelines to trace the attackerâ€™s activity|

## ğŸ§  Real-World Story: â€œThe Curious VPN Userâ€

A SOC analyst named **Neha** was on a routine shift monitoring alerts from the SIEM. She noticed a spike in **VPN logins** from a user account outside normal working hours.

ğŸ” **Log Events in SIEM:**

- Multiple login attempts â†’ **VPN log (network log)**
- Success at 2:14 AM â†’ **Suspicious**
- Access to sensitive folder `\\fileserver\R&D\2026-plans` â†’ **Windows File Share log**
- Downloaded 14 files â†’ **Host-centric logs showed file access**
- Ran an unknown executable â†’ **Sysmon log showed `research_tool.exe`**
    
â±ï¸ **Timeline correlation** in SIEM made it clear this was a possible insider threat or compromised credentials.

ğŸ”’ The SOC escalated to IR (Incident Response). Investigation revealed:

- The userâ€™s credentials had been phished
- Threat actor had been inside for 3 days
    
**Resolution:** Passwords reset, machine isolated, indicators of compromise shared across SIEM.

## ğŸ“ Summary

SIEM acts as the **central brain** for:
- Ingesting all logs in real-time
- Correlating data from host and network
- Detecting, visualizing, and responding to threats
    
Without SIEM:
- Analysts miss the forest for the trees
- Visibility gaps increase risk exposure
    
With SIEM:
- Security teams go from reactive to **proactive defense**.

---
# ğŸ“š Log Sources & Ingestion in a SIEM Environment

## ğŸ” What Are Logs?

Logs are **records of system activities** generated by devices and services in a network. They provide visibility into user actions, errors, system changes, network access, and more.

> ğŸ›¡ï¸ Logs form the **backbone of threat detection, forensic investigations, and compliance audits**.

## ğŸ’» Common Devices & Their Logs

### ğŸªŸ **Windows Machines**

Windows records nearly **every system activity** in the **Event Viewer**.
#### ğŸ”‘ Key Points:

- Each event is assigned a **unique Event ID**.
- Logs include:
    - Login events
    - Process creation
    - File access
    - System errors    
- View logs: `Start > Search > Event Viewer`
    

ğŸ“‚ **Example Log Categories**:

- **System** (device drivers, OS changes)
- **Security** (logins/logoffs, audit logs)
- **Application** (installed software logs)
- **PowerShell Operational** (scripts and commands run)
    
âœ… Forward these logs to a **SIEM** to correlate across endpoints.

### ğŸ§ **Linux Workstations**

Linux systems store logs in **/var/log/**.
#### ğŸ“„ Common Log Files:

| File Path                        | Description                         |
| -------------------------------- | ----------------------------------- |
| `/var/log/httpd` or `/apache`    | Apache request/response, error logs |
| `/var/log/cron`                  | Cron job activity                   |
| `/var/log/auth.log` or `/secure` | Login attempts, SSH access          |
| `/var/log/kern`                  | Kernel-related events               |

ğŸ“˜ **Sample cron log**:
```pgsql
May 28 13:04:20 ebr crond[2843]: no timestamp found (user root job sys-daily)
```

## ğŸŒ **Web Servers (Apache Example)**

Track HTTP/S requests/responses to detect:
- Web shells
- SQLi
- Command injection
- Reconnaissance (e.g., `curl`, `nmap`, etc.)
    
ğŸ“˜ **Sample Apache log**:
```apache.log
192.168.21.200 - - [21/Mar/2022:10:17:10] "GET /cgi-bin/try/ HTTP/1.0" 200 3395
```
## ğŸ§² Log Ingestion into SIEM

Once logs are generated, they need to be **ingested by the SIEM** for analysis.

### ğŸš€ Common Log Ingestion Methods
#### 1. **Agent / Forwarder**

- Lightweight tool installed on endpoints.
- Monitors log directories, config files, Windows Event Logs.
- Example: **Splunk Universal Forwarder**
    
ğŸ“¥ **Use Case**: Real-time collection from hundreds of endpoints.

#### 2. **Syslog**

- A **standard protocol** used widely in Linux/Unix systems.
- Sends logs from services like SSH, FTP, Apache, etc., to SIEM.
ğŸ“¥ **Use Case**: Consolidate logs from _firewalls, routers, Linux servers_.

#### 3. **Manual Upload**

- Used for **offline analysis**.
- Logs (in `.log`, `.csv`, `.json`, etc.) are manually uploaded to SIEM.
- Useful for forensic investigations and threat emulation labs.
ğŸ§ª **Tools**: Splunk, ELK, Graylog

#### 4. **Port Forwarding**

- SIEM listens on specific **TCP/UDP ports** (e.g., 514 for syslog).
- Devices push logs directly to these ports.
ğŸ“¥ **Use Case**: Quick integration for devices that canâ€™t run agents.

### ğŸ” Example: Splunk Ingestion Methods

|Method|Description|
|---|---|
|Agent|Real-time collection from endpoints|
|Syslog|Log forwarding from network appliances|
|Manual Upload|Upload `.evtx`, `.csv`, `.json`, etc.|
|Port Listener|Directly ingest logs pushed via network|
## ğŸ§  Summary

|System|Log Source|Log Location / Method|
|---|---|---|
|**Windows**|Event Viewer|Forwarder agent (e.g., Splunk UF)|
|**Linux**|`/var/log/` files|Syslog, agent, or port-based ingestion|
|**Web Server**|Apache/Nginx access/error logs|`/var/log/httpd` or `/var/log/apache2/`|
|**SIEM**|Aggregates, normalizes, correlates all logs|Real-time monitoring and alerting|

> ğŸ“Œ **Log correlation across hosts, apps, and the network gives true visibility and enables early threat detection.**

---
# ğŸ” SIEM & SOC Analyst Responsibilities

## ğŸ“Š What is SIEM?

**SIEM (Security Information and Event Management)** is a centralized solution for:
- **Collecting** logs from various sources (hosts, networks, applications, etc.) 
- **Correlating** events to detect suspicious patterns
- **Alerting** when a rule is triggered or a threshold is crossed
- **Providing visibility** into both host-centric and network-centric activities

## ğŸ§  Why SIEM Matters in Cybersecurity

SIEM acts as the **brain of the SOC**, helping analysts detect and respond to security threats in real time.

### ğŸ” SIEM Capabilities:

|Capability|Description|
|---|---|
|ğŸ”„ **Correlation**|Matches patterns across multiple sources (e.g., login + data access)|
|ğŸ‘ï¸â€ğŸ—¨ï¸ **Network & Host Visibility**|Tracks endpoint and communication behaviors|
|ğŸš¨ **Alerting**|Notifies analysts of potential threats based on rules/thresholds|
|ğŸ•µï¸â€â™‚ï¸ **Threat Hunting Support**|Enables manual investigation beyond rule-based alerts|
|ğŸ“‰ **Noise Reduction**|Helps tune out false positives and prioritize critical events|
|ğŸ“ **Historical Analysis**|Stores past logs for forensic investigations and compliance reports|

> âœ… SIEM is essential to **detect threats early** and **respond quickly** to limit damage.

## ğŸ§‘â€ğŸ’» SOC Analyst Responsibilities

Security Operations Center (SOC) analysts rely heavily on SIEM tools for monitoring and analysis.
### ğŸ¯ Core Responsibilities:

| Task                              | Description                                                           |
| --------------------------------- | --------------------------------------------------------------------- |
| ğŸ“¡ **Monitoring**                 | Continuously observe security alerts and logs from across the network |
| ğŸ” **Investigating Alerts**       | Analyze alerts to determine legitimacy and severity                   |
| âŒ **Identifying False Positives** | Spot non-malicious events mistakenly flagged as threats               |
| ğŸ› ï¸ **Tuning SIEM Rules**         | Refine alert logic to reduce noise and improve detection accuracy     |
| ğŸ“‹ **Reporting & Compliance**     | Generate reports for audits and management                            |
| ğŸ•³ï¸ **Covering Blind Spots**      | Identify missing log sources or unmonitored activity                  |

## ğŸ§  Analyst Tip: Think Like an Adversary

- Understand attacker **TTPs (Tactics, Techniques, Procedures)** from sources like MITRE ATT&CK.
- Use that knowledge to improve detection rules and hunting hypotheses.
- Keep tuning, iterating, and questioning whatâ€™s _not_ visible.
    
## ğŸ§° Tools Analysts Use with SIEM:

- ğŸ“ˆ **Dashboards** â€“ For real-time visibility
- ğŸ” **Search Queries (KQL, Lucene, etc.)** â€“ For investigations
- ğŸ§® **Correlation Rules / Detection Logic** â€“ For alerting
- ğŸ’¬ **Case Management / Ticketing Tools** â€“ For tracking response steps

## ğŸš¨ Real-Life SIEM Use Case

> ğŸ“Œ **Scenario**: A SIEM receives logs showing a user authenticating from two countries within 5 minutes.

- ğŸ” The SIEM correlates **geolocation** + **logon event** + **IP data**
- ğŸ§  Rule triggers a potential â€œ**Impossible Travel**â€ alert
- ğŸ•µï¸â€â™‚ï¸ SOC Analyst investigates: confirms itâ€™s compromised credentials
- âš™ï¸ Response initiated: password reset, session kill, endpoint isolation

---

# ğŸ“Š SIEM Rules, Dashboards & Alert Investigation

## ğŸ§© SIEM Log Ingestion

SIEM tools collect **security-related logs** through:

- ğŸ“¦ **Agents/Forwarders** (e.g., Splunk Universal Forwarder)
- ğŸ”Œ **Port Forwarding**
- ğŸ–¥ï¸ **Manual Uploads**
- ğŸ“¡ **Syslog Protocol**
    
Once logs are **ingested and normalized**, correlation rules scan for **unwanted behavior or suspicious patterns**. If matched, an **alert is triggered**.

## ğŸ“ˆ SIEM Dashboards

Dashboards present **actionable insights** from raw event data in a visual format.
### âœ… Typical Dashboard Widgets:

- ğŸš¨ **Alert Highlights**
- âš™ï¸ **System Notifications**
- â¤ï¸ **Health/Heartbeat Status**
- ğŸ‘¤ **Failed Login Attempts**
- ğŸ“Š **Total Events Ingested**
- ğŸ” **Rules Triggered**
- ğŸŒ **Top Domains Visited**
    
> ğŸ§  Custom dashboards can be created based on role (SOC Level 1, Threat Hunter, etc.).

### ğŸ“· Example: _QRadar Default Dashboard_

- Quick overview of recent alerts, system health, and log volume
- Rule triggers visualized over time
- Geolocation of inbound/outbound connections
    
## âš–ï¸ Correlation Rules

**Correlation rules** are logical conditions to detect suspicious behavior based on field-value pairs in logs.

### ğŸ”„ Common Rule Examples:

| Rule Scenario             | Condition                                                       |
| ------------------------- | --------------------------------------------------------------- |
| ğŸ”‘ Multiple Failed Logins | If user fails login **5 times in 10 seconds**, raise alert      |
| âœ… Success After Failures  | If login is successful **after multiple failures**, raise alert |
| ğŸ’¾ USB Usage Detection    | If **USB device plugged**, trigger alert (if restricted)        |
| ğŸ“¤ Data Exfiltration      | If **outbound traffic > 25MB**, trigger alert                   |

## ğŸ§ª Sample Use Cases

### ğŸ§¹ Use Case 1: Event Log Cleared

- **Tactic**: Adversary clears logs to hide tracks
- **Event ID**: `104` (Windows Event Log cleared)
    
```txt
IF LogSource = WinEventLog AND EventID = 104 THEN Alert = "Event Log Cleared"
```

### ğŸ§ Use Case 2: Suspicious Command (whoami)

- **Tactic**: Adversary checks current privileges
- **Event ID**: `4688` (Process Creation)
- **Field to monitor**: `NewProcessName`


```txt
IF LogSource = WinEventLog AND EventID = 4688 AND NewProcessName CONTAINS "whoami" THEN Alert = "WHOAMI Command Detected"
```

> ğŸ” Other sensitive command examples: `net user`, `ipconfig`, `powershell`, `cmd.exe`


## ğŸ•µï¸ Alert Investigation Workflow

Once a rule is triggered, the **SOC Analyst** takes the following steps:

1. ğŸ“¥ **Review Alert** on dashboard (source IP, user, command, etc.)
2. ğŸ§® **Analyze Rule Conditions** â€“ Which field-value pairs matched?
3. ğŸ” **Classify Alert**:
    - **False Positive** â†’ Tune rule (e.g., suppress known-good activity)
    - **True Positive** â†’ Begin deeper investigation
4. ğŸ§‘â€ğŸ’» **Actions Taken**:
    - Contact endpoint/asset owner
    - Correlate with other logs or PCAPs
    - Confirm malicious intent
5. ğŸš¨ **Respond**:
    - Isolate infected machine
    - Block malicious IP/domain
    - Trigger IR process (if needed)
        
## ğŸ§  Key Takeaways

- Rules depend on **normalized logs** with consistent fields.
- Dashboards help prioritize alerts visually.
- Rules can evolve â€“ **tuning is essential**.
- Not every alert is malicious â€” **context matters**.

---

