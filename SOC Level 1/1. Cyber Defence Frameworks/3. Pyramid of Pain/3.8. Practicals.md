# ğŸ§± Pyramid of Pain â€“ APT Detection Exercise Checklist

## ğŸ“Œ Objective
Apply the Pyramid of Pain framework to analyze an APT group and design effective detection strategies based on their indicators and behaviors.

---

## ğŸ” Step 1: Select an APT Group
- [ ] Visit [MITRE ATT&CK APT Groups](https://attack.mitre.org/groups/) or [Rapid7 Threat Groups](https://attack.mitre.org/groups/)
- [ ] Choose an APT group to investigate (e.g., APT28, APT29, Lazarus Group)
- [ ] Note down the group's known aliases and origins
- [ ] Identify primary attack goals (espionage, financial, destruction)

---

## ğŸ“¦ Step 2: Gather Indicators of Compromise (IOCs)

### ğŸŸ© Green Zone â€“ Low Pain (Easy to Change)
- [ ] File hash values (e.g., MD5, SHA-1, SHA-256)
- [ ] IP addresses
- [ ] Domain names (including Punycode and URL shorteners)

### ğŸŸ¨ Yellow Zone â€“ Medium Pain (Moderate to Change)
- [ ] Host Artifacts (e.g., registry keys, scheduled tasks, startup entries)
- [ ] Network Artifacts (e.g., User-Agent strings, URI patterns, C2 protocols)

### ğŸŸ¥ Red Zone â€“ High Pain (Hard to Change)
- [ ] Tools used (e.g., Cobalt Strike, Mimikatz, custom EXEs/DLLs)
- [ ] TTPs â€“ Tactics, Techniques, and Procedures (MITRE ATT&CK matrix)

---

## ğŸ§  Step 3: Map to Pyramid of Pain
For each IOC:
- [ ] Identify the Pyramid of Pain level (Green / Yellow / Red)
- [ ] Ask: _How difficult would it be for the attacker to change this?_
- [ ] Prioritize detections from **Yellow and Red** zones

---

## ğŸ§° Step 4: Create Detection Rules and Approaches

### ğŸ”’ What to monitor:
- [ ] Endpoint logs (Windows Event Logs, Sysmon, EDR)
- [ ] Network traffic (Proxy logs, Firewall, PCAPs)
- [ ] DNS queries and responses
- [ ] File system and process activity

### ğŸ›¡ï¸ Detection techniques:
- [ ] Write YARA rules for tool/malware signatures
- [ ] Use Sigma rules for SIEM alerts
- [ ] Create IDS/IPS rules (e.g., Snort, Suricata)
- [ ] Correlate behavior with MITRE ATT&CK techniques

---

## ğŸ§ª Step 5: Optional Tools and Resources
- **Malware & Hash Lookup**:
  - [VirusTotal](https://www.virustotal.com)
  - [MalwareBazaar](https://bazaar.abuse.ch)
  - [Malshare](https://malshare.com)

- **Detection Rules**:
  - [SOC Prime Threat Detection Marketplace](https://tdm.socprime.com/)
  - [Sigma Rules](https://github.com/SigmaHQ/sigma)
  - [YARA Rules](https://yara.readthedocs.io)

- **Fuzzy Hashing**:
  - [SSDeep](https://ssdeep-project.github.io/)

---

## ğŸ“ Reflection Questions
- [ ] What kind of indicators are easiest to detect?
- [ ] What kinds of indicators would frustrate or stop the attacker?
- [ ] How could I integrate this detection into my existing defense tools?

> â€œThe amount of pain you cause an adversary depends on the types of indicators you are able to make use of.â€ â€” David Bianco

