# 🧠 Cyber Kill Chain (CKC) – Overview & Phases

## 📖 What is the Kill Chain?
The **Kill Chain** is a military-derived concept that represents the steps an adversary must go through to successfully complete an attack. In cybersecurity, **Lockheed Martin** adapted this in 2011 to define the **Cyber Kill Chain®**, a model for identifying and preventing cyber intrusions.

---

## 🎯 Why It Matters
Understanding the Cyber Kill Chain:
- Helps in defending against **ransomware**, **APTs**, and **breaches**
- Assists in identifying **gaps** in security controls
- Enables **SOC Analysts, Threat Hunters, and Incident Responders** to trace and disrupt attacks
- Provides a structured approach to **attack detection and mitigation**

---

## 🧱 Cyber Kill Chain – Attack Phases

### 1. 🕵️‍♂️ Reconnaissance
- **Goal**: Gather information about the target.
- **Examples**: Google dorking, social engineering, WHOIS lookup, port scanning.
- **Defense**: Monitor passive DNS, use honeypots, block IPs doing large-scale scanning.

---

### 2. ⚔️ Weaponization
- **Goal**: Couple malware with a delivery mechanism.
- **Examples**: Embedding payloads into PDFs, Office macros, or spearphishing attachments.
- **Defense**: Sandboxing, static/dynamic analysis, YARA rule scanning.

---

### 3. 🚚 Delivery
- **Goal**: Deliver the weaponized file to the victim.
- **Examples**: Phishing emails, USB drops, malicious links.
- **Defense**: Email filtering, attachment scanning, user training.

---

### 4. 💥 Exploitation
- **Goal**: Execute the payload on the victim’s system.
- **Examples**: Exploiting software vulnerabilities, malicious scripts.
- **Defense**: Patch management, endpoint protection, application whitelisting.

---

### 5. 🧬 Installation
- **Goal**: Establish persistence on the system.
- **Examples**: Installing backdoors, registry modifications, adding services.
- **Defense**: Monitor file system, detect persistence mechanisms (Sysmon), use EDR solutions.

---

### 6. 🎮 Command & Control (C2)
- **Goal**: Establish remote control over the compromised host.
- **Examples**: HTTP/S beacons, DNS tunneling, custom C2 protocols.
- **Defense**: Detect unusual traffic, proxy logs, C2 blacklist monitoring, behavior-based rules.

---

### 7. 🎯 Actions on Objectives
- **Goal**: Achieve the final mission (exfiltration, destruction, ransomware).
- **Examples**: Data theft, deploying ransomware, credential harvesting.
- **Defense**: DLP tools, data integrity monitoring, rapid incident response.

---

## 🔁 Summary
Each step in the Cyber Kill Chain gives defenders a **chance to detect and stop** the intrusion. Breaking the chain early reduces attacker success and impact.

> “The sooner you disrupt the kill chain, the better your chances of stopping the breach.” – Cyber Defense Principle

----

# 🛡️ Phase 1: Reconnaissance Phase

## 📌 What is Reconnaissance?

Reconnaissance is the first phase of the Cyber Kill Chain where adversaries gather information about a potential target. This includes technical details, organizational structure, and personal data of employees.

- **Objective**: Understand the target and identify potential vulnerabilities.
- **Also known as**: The planning phase of an attack.

---

## 🔍 OSINT (Open-Source Intelligence)

OSINT refers to collecting publicly available information from a variety of online sources. It's commonly used in reconnaissance.

### Common OSINT Sources:
- Company websites
- Employee directories
- Job postings
- News articles
- Public data repositories
- Social media (LinkedIn, Twitter, Facebook, Instagram)

---

## ✉️ Email Harvesting

Email harvesting is a technique used to collect email addresses for potential phishing campaigns.

### Tools Used:
- **theHarvester**: Gathers emails, names, IPs, and more using public sources.
- **Hunter.io**: Extracts contact information associated with domains.
- **OSINT Framework**: Provides categorized OSINT tools for various use cases.

---

## 🧠 Key Takeaways

- Reconnaissance is about **information gathering** and **target profiling**.
- OSINT plays a major role by giving attackers insight without direct interaction.
- **Email harvesting** is often used for crafting **phishing campaigns**.
- Social media can reveal a **treasure trove** of details useful to attackers.

---

## 📚 Reference

- Varonis article: [What is OSINT?](https://www.varonis.com/blog/osint)
- OSINT Framework: [https://osintframework.com](https://osintframework.com)

---

# 🛡️ Phase 2: Weaponization Phase

## 📌 What is Weaponization?

Weaponization is the second phase of the Cyber Kill Chain. In this stage, the attacker crafts a **weaponized payload** by combining **malware** and an **exploit** to create a deliverable used in the next stage (Delivery).

- **Objective**: Prepare an exploit and bind it with malware for deployment to the target.
- **No direct interaction with the target** occurs in this phase.

---

## 💡 Key Terminology

- **Malware**: Malicious software designed to damage, disrupt, or gain unauthorized access.
- **Exploit**: Code that takes advantage of a vulnerability in a system or application.
- **Payload**: The malicious component delivered via the exploit.
- **Backdoor**: A method of bypassing normal authentication to access a system.
- **C2 (Command and Control)**: Communication channel between attacker and compromised system.

---

## 🧪 Attacker Actions in Weaponization

- Use tools to **generate malware automatically**.
- Purchase malware or payloads from the **Dark Web**.
- Create infected files (e.g., **MS Office documents with VBA macros**).
- Implant malware on **USB drives** or other removable media for social engineering-based delivery.
- Select **C2 infrastructure** for future communication and payload delivery.
- Choose or develop a **backdoor implant** to maintain persistence on the victim machine.

---

## 🎯 Real-World Example

- "Megatron" buys a ready-made **payload** from the Dark Web to save time.
- Embeds the payload in a malicious **Office document** with macro scripts.
- Plans to distribute it via **phishing email** or **USB drop**.

---

## 🧠 Key Takeaways

- Weaponization is **quiet but critical**—no alerts are raised during this phase.
- Malware + Exploit = **Weaponized Payload**
- The attacker is now **prepared to strike** in the next stage (Delivery).
- **C2 and backdoors** are chosen now for later use in post-exploitation.

---

## 📚 References

- TrustedSec: [Intro to Macros and VBA For Script Kiddies](https://www.trustedsec.com/blog/intro-to-macros-and-vba/)
- MITRE ATT&CK: [Command and Control Techniques](https://attack.mitre.org/tactics/TA0011/)

---
# 📦 Phase 3: Delivery Phase

## 📌 What is Delivery?

The **Delivery** phase is where the attacker transmits the **weaponized payload** to the intended victim. This is the **first point of contact** between the attacker and the target.

- **Objective**: Deliver the malicious payload via various channels.
- This phase **initiates the execution** of the attack chain.

---

## 🚚 Common Delivery Methods

### 1. **Phishing Emails**
- Emails crafted to lure the victim into opening a malicious attachment or link.
- **Spearphishing**: Targets a specific individual or department using personalized information.
- **Example**:  
  "Megatron" learns Nancy from Sales frequently interacts with Scott from another company. He spoofs Scott’s identity and sends Nancy a **fake invoice email** containing the malware.

### 2. **Infected USB Devices**
- Dropping USB drives in public areas or **mailing them** directly to the organization.
- Drives often **branded with the company logo** to appear trustworthy.
- Example article:  
  📖 *Cybercriminal group mails malicious USB dongles to targeted companies* – CSO Online

### 3. **Watering Hole Attacks**
- Compromise a **legitimate website** frequently visited by the target group.
- Redirect victims to a malicious site or automatically download malware (**drive-by download**).
- Often paired with **emails or links** to encourage visits.
- Example: A **pop-up download** for a fake browser extension.

---

## 🎯 Attacker Actions in Delivery

- Choose a delivery method based on **reconnaissance** results.
- Ensure payload is **embedded in believable formats** (e.g., Word documents, PDFs, USBs).
- Prepare **domain spoofing** or compromise legitimate sites for better trust.
- Set up **fake but convincing scenarios** to encourage victim interaction.

---

## 🧠 Key Takeaways

- Delivery is the **first active interaction** with the target.
- Success in this phase relies heavily on **social engineering and deception**.
- Attacker builds trust through **reconnaissance insights** to make delivery more convincing.
- **No execution** of the payload happens here — just **transmission**.

---

## 🔗 References

- CSO Online: [Cybercriminal group mails malicious USB dongles](https://www.csoonline.com/article/564783/cybercriminal-group-mails-malicious-usb-dongles-to-targeted-companies.html)

---
# 💥 Phase 4: Exploitation Phase

## 📌 What is Exploitation?

The **Exploitation** phase begins once the attacker successfully delivers the malicious payload and the victim interacts with it. The goal is to **execute the code** and **gain control** of the system.

- This is where **vulnerabilities are actively abused**.
- The exploitation can be triggered through **user interaction** or **automated vulnerability abuse**.

---

## 🎭 "Megatron's" Exploitation Strategy

- Created **two phishing emails**:
  1. A **phishing link** to a fake Office 365 login page.
  2. A **macro-laden attachment** that triggers ransomware when opened.
- Result: Two victims fell for the bait — **one clicked the link**, the other **opened the malicious document**.

---

## 🧠 Common Exploitation Techniques

### 1. **User-Triggered Exploits**
- Victim opens a malicious file or clicks a phishing link.
- Triggers macro execution, shellcode, or credential harvesting.

### 2. **Zero-Day Exploits**
- **Undisclosed and unpatched vulnerabilities** used by attackers.
- Leave **no initial opportunity for detection**.
- Reference: FireEye – "A zero-day vulnerability is an unknown exploit in the wild…"

### 3. **Server or Software Exploits**
- Exploiting known vulnerabilities in:
  - Web servers
  - Operating systems
  - Network services
- Goal: **Privilege escalation** or lateral movement.

### 4. **Social Engineering**
- Exploiting **human behavior** and **trust** as a vulnerability.

---

## 🔄 Post-Exploitation Activities

- **Privilege Escalation**: Gain admin or system-level access.
- **Lateral Movement**: Move across systems in the network.
  - Definition (CrowdStrike): Techniques to move deeper into a network after gaining initial access.

---

## 📚 Resources

- 🛡️ TryHackMe Room: [OWASP Top 10](https://tryhackme.com/room/owasptop10)
- 🔥 FireEye: [Zero-day Exploits](https://www.fireeye.com/current-threats/what-is-a-zero-day-exploit.html)
- ⚔️ CrowdStrike: [Lateral Movement](https://www.crowdstrike.com/cybersecurity-101/lateral-movement/)

---

## 🧠 Key Takeaways

- This is the **execution phase** — malicious code is run, and initial access is solidified.
- Exploits can be **technical (software)** or **social (human-based)**.
- **Zero-days** are extremely dangerous and often used by **nation-state attackers**.
- Exploitation opens the door to **deeper compromise** in the next phases of the Kill Chain.

---

# 🧱 Phase 5: Installation Phase

## 📌 What is Installation?

The **Installation** phase is where the attacker ensures long-term access to the victim’s system by installing **backdoors** or other forms of **persistence**.

- Backdoors = Secret access points
- Goal = Enable reentry even if initial access is lost or removed

> 🎯 Objective: Achieve **persistence** so the attacker can continue operations uninterrupted.

---

## 🦠 Common Installation Techniques

### 1. 🔧 **Web Shells**
- Scripts written in **PHP**, **ASP**, **JSP**, etc.
- Installed on **compromised web servers**
- Provide **remote access** via browser
- Difficult to detect due to **benign-looking file formats**
- 📚 [Microsoft's article on web shells](https://www.microsoft.com/security/blog/2021/02/22/web-shell-attacks-continue-to-rise/)

### 2. 🛠️ **Meterpreter Backdoor (Metasploit)**
- Interactive shell used by attackers
- Can execute commands, scripts, and maintain access remotely
- Payloads can be configured for **persistence** on reboot

### 3. ⚙️ **Creating/Modifying Windows Services**
- **MITRE ATT&CK ID**: `T1543.003`
- Tools: `sc.exe`, `reg.exe`
- Create services to **relaunch payloads** on startup
- **Masquerading** technique: use service names that look legitimate

### 4. 🪟 **Registry Run Keys & Startup Folder**
- Places payloads in startup paths so they auto-execute on login
- Supports **user-specific** or **system-wide** persistence
- Reference: [MITRE ATT&CK – Registry Run Keys](https://attack.mitre.org/techniques/T1547/001/)

---

## 🕒 🎭 Timestomping Technique

- Used to **alter file timestamps** (Created, Accessed, Modified)
- Helps malware blend in with legitimate system files
- Makes forensic investigations more difficult
- Common anti-forensic technique

---

## 📚 Resources

- 🧠 TryHackMe: [Windows Persistence Room](https://tryhackme.com/room/windows10persistence)
- 🧾 MITRE ATT&CK: [T1543.003 - Create or Modify System Process](https://attack.mitre.org/techniques/T1543/003/)
- 🗂️ MITRE ATT&CK: [T1547.001 - Registry Run Keys / Startup Folder](https://attack.mitre.org/techniques/T1547/001/)

---

## 🧠 Key Takeaways

- Installation ensures **long-term access**.
- Persistence techniques vary across **OS**, **user privilege**, and **environment**.
- Blending in (masquerading, timestomping) increases stealth and reduces detection chances.
- Attackers use **legitimate tools** (e.g., Windows utilities) to achieve persistence.

---


# 🕹️ Phase 6: Command and Control (C2) Phase

## 📌 What is C2?

**Command and Control (C2)**, also known as **C&C**, is the phase where the attacker establishes a remote communication channel between the infected host and their own infrastructure.

- Also known as **C2 Beaconing** — infected hosts "phone home" to the attacker's server
- Allows attacker to **control, manipulate, and exfiltrate** data
- Key for issuing **commands**, deploying **additional payloads**, or **spreading laterally**

> 🎯 Objective: Establish a **reliable and stealthy channel** for continued access and control

---

## 📡 How C2 Works

1. Malware is executed on the victim's machine
2. Malware initiates outbound connection to attacker's **C2 server**
3. A communication channel is established
4. Attacker issues commands remotely (e.g., file exfiltration, more payloads)
5. C2 traffic is made to look **benign** to evade detection

---

## 🔁 Legacy vs Modern C2 Channels

### ❌ Obsolete Method:
- **IRC (Internet Relay Chat)**
  - Used to be a common C2 method
  - Now easily detectable by modern firewalls/IDS systems

### ✅ Common Modern C2 Channels:

#### 🌐 1. **HTTP / HTTPS (Ports 80 & 443)**
- **Most popular method**
- Blends with normal web traffic (e.g., user browsing)
- Can **bypass firewalls** and avoid suspicion

#### 🌐 2. **DNS (Domain Name System)**
- Known as **DNS Tunneling**
- Encodes C2 messages in DNS queries/responses
- Useful for **bypassing restrictions** and **maintaining stealth**
- Hard to detect in noisy DNS traffic

---

## 🔗 Ownership of C2 Infrastructure

- The **adversary** can:
  - Host their own C2 servers
  - Use **compromised systems** as relay points
- C2 infrastructure can be:
  - On-premise
  - Cloud-based
  - **Decentralized** (e.g., P2P C2)

---

## 🧠 Key Takeaways

- C2 is the remote control link between attacker and victim
- Attackers favor **stealth** and **resilience**
- Modern C2 uses **web and DNS traffic** to avoid detection
- Once C2 is active, attacker has full operational control

---
# 🎯 Phase 7: Actions on Objectives

## 🧑‍💻 What is "Actions on Objectives"?

This is the final phase of the Cyber Kill Chain, where the attacker **executes their mission goals** after gaining full access. Now that "Megatron" has persistent and remote control of the victim's environment, they can proceed to exploit that access in line with their original intentions.

> 🧠 Think: "Now that I'm in, what do I want to do with it?"

---

## ⚙️ Common Objectives for Attackers

### 🟢 Credential Theft
- Extract saved credentials using tools like **Mimikatz**
- Access email, internal apps, or cloud services

### 🔐 Privilege Escalation
- Move from regular user to **domain admin**
- Exploit misconfigurations or unpatched vulnerabilities

### 🧭 Internal Reconnaissance
- Explore internal systems, applications, and networks
- Identify high-value targets and pivot points

### 🔄 Lateral Movement
- Jump from one system to another within the same network
- Use legitimate tools (e.g., **RDP, SMB, PsExec**) to avoid detection

### 📦 Data Exfiltration
- Steal sensitive documents, source code, customer data, etc.
- Compress and encrypt files before uploading to attacker-controlled server

### 🧹 Data Destruction / Tampering
- Delete **backups** and **Volume Shadow Copies**
  - Shadow Copy = Microsoft backup snapshots
- **Corrupt or overwrite** critical files and databases

---

## 🧠 Key Takeaways

- This is where the **real-world damage** happens
- Each action is driven by the **attacker’s motive** (e.g., espionage, financial gain, sabotage)
- Goals may vary:
  - **Data theft**
  - **Disruption**
  - **Ransom demand**
  - **Reputation damage**

> 🎬 At this point, the attacker has **fully compromised** the organization and can act freely — unless detected and stopped.

---
# ⚔️ Cyber Kill Chain: Conclusion
## 🚫 Limitations of the Traditional Cyber Kill Chain

While the **Cyber Kill Chain** is an invaluable tool for improving network defense, it's **not perfect** and shouldn't be relied upon exclusively. Here’s why:

### 🕰️ **Outdated Framework**
- The traditional **Cyber Kill Chain** was established in **2011**, and has not been updated since.
- The cybersecurity landscape has changed drastically, making some of its principles outdated and less effective against modern threats.

### ⚔️ **Designed for Network Perimeter & Malware Defense**
- Originally, the Cyber Kill Chain was built to secure the **network perimeter** and protect against **malware** delivery. This focus does not cover all current attack vectors.

### 🚪 **Inability to Detect Insider Threats**
- Insider threats are not accounted for in the traditional Cyber Kill Chain model.
- **Insider Threat**: "The potential for an insider to use their authorized access to harm the organization."
- The Cyber Kill Chain mainly focuses on external threats, missing critical internal risks.

---

## 🧠 **Evolution of Threats: Adversary TTPs**

- Modern adversaries now combine **multiple tactics, techniques, and procedures (TTPs)** to achieve their objectives. 
- Adversaries can defeat traditional **threat intelligence** by modifying file hashes, IP addresses, and other indicators.
  
> 🧩 **Threat Intelligence** can be bypassed by adversaries using **dynamic TTPs** — requiring more adaptive defense strategies.

---

## 🛠️ **Beyond Cyber Kill Chain: Adding MITRE ATT&CK & Unified Kill Chain**

### 🧭 **MITRE ATT&CK**
- **MITRE ATT&CK** is a knowledge base of adversary tactics and techniques based on real-world scenarios. It’s a more granular and flexible approach, useful for threat hunting and detection.
- It helps detect adversary behaviors across the entire attack lifecycle, especially focusing on **post-exploitation** stages.

### 🔗 **Unified Kill Chain**
- The **Unified Kill Chain** is an extended model designed to overcome the limitations of the traditional Cyber Kill Chain by incorporating insights from **MITRE ATT&CK**.
- It covers the **full spectrum of attacks**, including **insider threats** and **advanced persistent threats (APTs)**.

---

## 💡 **Conclusion: A More Comprehensive Defense**

- While the Cyber Kill Chain remains a useful tool, it should be supplemented with more modern frameworks like **MITRE ATT&CK** and the **Unified Kill Chain** to provide a **comprehensive approach** to security.
- By using multiple frameworks together, organizations can better defend against **sophisticated adversaries**, **insider threats**, and the **evolving cybersecurity landscape**.

