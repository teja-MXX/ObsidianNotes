# 🎯 Story: The Pyramid Unfolds

Arjun had barely sipped his morning coffee when the first alert came in— a hash match triggered in the SIEM. It was tied to a known malware sample: a ransomware strain identified last week in threat intel feeds.

He knew hashes were easy to detect, but also easy to change. Attackers could recompile the malware and bypass hash-based detection within seconds. Still, it was a clue, and he opened an incident ticket.

Moments later, a second alert pinged. This time, it flagged communication with a blacklisted IP address. The IP was linked to a known command-and-control server. Arjun blocked the IP at the firewall level and made a quick note: “This layer’s painful for attackers but still changeable.”

A few minutes later, DNS logs revealed something new—the compromised endpoint had queried a suspicious domain: `update-storage-security[.]com`. This wasn't in their allowlist. He checked threat feeds and confirmed it was a recently registered domain used in phishing campaigns.

As he dug deeper, he noticed strange files in the user's `AppData\Roaming` folder. One was a renamed executable with persistence mechanisms—a **host artifact**. These were slightly harder to catch and revealed how the malware stayed alive even after reboot.

Network logs showed repeat beaconing behavior at regular intervals. Arjun correlated the timestamps and identified a specific pattern in the traffic—a **network artifact**. He added a new detection rule for that exact packet size and interval combo.

Then came the big clue—threat intel linked this intrusion to an attacker group known for using **Cobalt Strike**. That’s when Arjun realized they weren’t dealing with just malware—they were dealing with a human adversary using **tools** that required deep detection strategies.

Rhea from Tier 2 stepped in to help. Together, they mapped out the attacker’s **TTPs**—from initial phishing, persistence, to lateral movement using WMI ( **Windows Management Instrumentation** ) . This was the toughest layer. TTPs don’t change as easily as hashes or IPs. Understanding them meant understanding the enemy’s mindset.

By the end of the shift, Arjun had watched the entire Pyramid of Pain unfold—from the bottom with trivial indicators, all the way to the top with behavioral patterns. And with every step upward, he saw how much more impact defenders could have—if they aimed higher.

---

**Tags**:: #PyramidOfPain #Cybersecurity #SOC #Story #TTPs #DetectionEngineering #ObsidianLearning
