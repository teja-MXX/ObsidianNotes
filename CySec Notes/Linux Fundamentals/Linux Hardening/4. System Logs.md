# ğŸ§¾ System Logs

System logs on Linux are a set of files that contain information about the system and the activities taking place on it. These logs are essential for:

- Monitoring system behavior
- Troubleshooting issues
- Tracking application activity
- Detecting security events
    
---

## ğŸ” Importance in Security

System logs are a **valuable source** for identifying potential security weaknesses and vulnerabilities. By analyzing logs, we can:

- Understand system behavior and network activity
- Detect unauthorized logins and attempted attacks
- Spot clear-text credentials
- Track unusual file access
- Identify signs of potential security breaches
    

---

## ğŸ§ª For Penetration Testers

Penetration testers can **review logs after testing** to determine:
- If activities triggered **intrusion detection alerts** or **system warnings**
- The **effectiveness of security tests**
- Ways to **refine testing strategies**
- Areas where **security posture can be improved**
    

---

## âš™ï¸ Proper Log Configuration

To ensure log security and manageability:

- âœ… Set appropriate **log levels**
- ğŸ”„ Configure **log rotation** to avoid oversized files
- ğŸ”’ Ensure logs are **secure and access-controlled**
- ğŸ‘ï¸ Regularly **review and analyze** logs to catch threats early
    

---

## ğŸ“ Types of Linux System Logs

Here are common types of logs on Linux:

- **ğŸ§  Kernel Logs** â€“ Messages from the Linux kernel
- **ğŸ’» System Logs** â€“ General operating system and service events
- **ğŸ” Authentication Logs** â€“ Login attempts, sudo usage
- **ğŸ“¦ Application Logs** â€“ Logs generated by specific applications
- **ğŸ›¡ï¸ Security Logs** â€“ Events from security modules (e.g., SELinux, AppArmor)

### ğŸ§¬ Kernel Logs

- **Path**: `/var/log/kern.log`
- Contains messages from the **kernel** (hardware drivers, system calls).
- Useful for identifying:
    - Vulnerable or outdated drivers
    - Crashes, DoS-related errors
    - Suspicious system calls (potential malware)
- Monitor regularly for anomalies.

### âš™ï¸ System Logs

- **Path**: `/var/log/syslog`
- Tracks system-level events:
    - Service start/stop
    - Reboots
    - Login attempts
        
- Use this to:
    - Detect unauthorized access
    - Identify system issues (e.g., failed service startups)
    - Analyze service behavior

### ğŸ” Authentication Logs

- **Path**: `/var/log/auth.log`
- Focuses on user authentication:
    - Successful & failed login attempts
    - sudo usage   
- Valuable for:
    - Detecting brute force attacks
    - Tracing privilege escalation attempts
    - Monitoring for suspicious authentication patterns
        
ğŸ“ **Example Insight**:

- User `admin` logs in using a public key.
- Admin belongs to `sudoers`.
- Unexpected traffic on port 22 noted.
- Sessions created for `admin` and `root`.


### ğŸ§¾ Application Logs

- Paths vary:
    - Apache: `/var/log/apache2/error.log`
    - MySQL: `/var/log/mysql/error.log`
        
- Useful for:
    - Web server & database monitoring
    - Identifying data handling issues
    - Detecting unauthorized requests
        
### ğŸ›¡ï¸Access Logs
- Record logins, file access, and network connections. 
- An example entry in an access log file can look like the following:
```bash
2023-03-07T10:15:23+00:00 servername privileged.sh: htb-student accessed /root/hidden/api-keys.txt
```
I
- In this log entry, we can see that the userÂ `htb-student`Â used theÂ `privileged.sh`Â script to access theÂ `api-keys.txt`Â file in theÂ `/root/hidden/`Â directory. On Linux systems, most common services have default locations for access logs:

| **Service**   | **Description**                                                                                   |
|---------------|---------------------------------------------------------------------------------------------------|
| Apache        | Access logs are stored in the `/var/log/apache2/access.log` file (or similar, depending on distro). |
| Nginx         | Access logs are stored in the `/var/log/nginx/access.log` file (or similar).                      |
| OpenSSH       | Access logs are stored in the `/var/log/auth.log` (Ubuntu) or `/var/log/secure` (CentOS/RHEL).   |
| MySQL         | Access logs are stored in the `/var/log/mysql/mysql.log` file.                                   |
| PostgreSQL    | Access logs are stored in the `/var/log/postgresql/postgresql-<version>-main.log` file.          |
| Systemd       | Access logs are stored in the `/var/log/journal/` directory.                                     |

### ğŸ› ï¸ **Audit Logs**
- Log critical system events (e.g., config changes, file modifications).

### ğŸ›¡ï¸Security Logs
- Paths vary by tool:
    - **Fail2Ban**: `/var/log/fail2ban.log`
    - **UFW**: `/var/log/ufw.log`
    - Other logs: `/var/log/syslog`, `/var/log/auth.log`
        

ğŸ“Œ Use for:
- Identifying brute-force attempts
- Reviewing firewall activity
- Spotting configuration tampering

## ğŸ” Spaced Repetition

#flashcards 
### System Logs â€“ Regular Flashcards

What are system logs in Linux used for?:: Monitoring and troubleshooting the system; identifying security weaknesses, unusual activities, and verifying penetration testing impact.
<!--SR:!2025-05-02,1,230-->

Where are kernel logs stored in Linux?:: /var/log/kern.log
<!--SR:!2025-05-05,4,270-->

What kind of information can kernel logs provide?:: Hardware drivers, system calls, kernel events, crashes, DoS indicators, and suspicious system calls.
<!--SR:!2025-05-02,1,230-->

Where are system logs stored in Linux?:: /var/log/syslog
<!--SR:!2025-05-05,4,270-->

What do authentication logs record?:: Successful and failed user authentication attempts.
<!--SR:!2025-05-05,4,270-->

Where are authentication logs stored?:: /var/log/auth.log
<!--SR:!2025-05-05,4,270-->

Where are Apache access logs stored?:: /var/log/apache2/access.log
<!--SR:!2025-05-05,4,270-->

Where are Nginx access logs stored?:: /var/log/nginx/access.log
<!--SR:!2025-05-05,4,270-->

Where are OpenSSH access logs stored on Ubuntu?:: /var/log/auth.log
<!--SR:!2025-05-02,1,230-->

Where are OpenSSH access logs stored on CentOS/RHEL?:: /var/log/secure
<!--SR:!2025-05-02,1,230-->

Where are MySQL access logs stored?:: /var/log/mysql/mysql.log
<!--SR:!2025-05-02,1,230-->

Where are PostgreSQL access logs stored?:: /var/log/postgresql/postgresql-version-main.log
<!--SR:!2025-05-04,3,250-->

Where are systemd logs stored?:: /var/log/journal/
<!--SR:!2025-05-02,1,230-->

What are application logs useful for?:: Understanding how applications handle data, identifying misconfigurations or unauthorized access, and investigating data exfiltration.
<!--SR:!2025-05-02,1,230-->

What are access logs?:: Logs that track login attempts, file accesses, and network connections.
<!--SR:!2025-05-02,1,230-->

What are audit logs?:: Logs that record modifications to system files, configurations, and other security-relevant events.
<!--SR:!2025-05-02,1,230-->

What are examples of tools to analyze logs on Linux?:: tail, grep, sed
<!--SR:!2025-05-02,1,230-->

### Cloze Flashcards

 ==/var/log/kern.log== is the default file where kernel logs are stored.
<!--SR:!2025-05-02,1,230-->

Kernel logs help identify ==suspicious system calls and vulnerable or outdated drivers==.
<!--SR:!2025-05-02,1,230-->

 ==/var/log/syslog== contains general system-level events like service starts, stops, and reboots.
<!--SR:!2025-05-02,1,230-->

The ==/var/log/auth.log== file specifically logs authentication attempts, unlike the broader syslog.
<!--SR:!2025-05-05,4,270-->

Logs in ==/var/log/apache2/access.log== can help trace web server access patterns.
<!--SR:!2025-05-02,1,230-->

==Application logs== are specific to programs like Apache, MySQL, and help identify issues with those apps.
<!--SR:!2025-05-02,1,230-->

 ==Audit logs== track sensitive changes, like modifications to configuration files.
<!--SR:!2025-05-05,4,270-->

==Fail2ban== records failed logins in ==/var/log/fail2ban.log==.
<!--SR:!2025-05-02,1,230!2025-05-05,4,270-->

==UFW firewall== logs are stored in ==/var/log/ufw.log==.
<!--SR:!2025-05-02,1,230!2025-05-04,3,250-->

Linux log files can be reviewed using tools like ==tail, grep, and sed==.
<!--SR:!2025-05-02,1,230-->

The PostgreSQL logs are typically stored in ==/var/log/postgresql/postgresql/main.log==.
<!--SR:!2025-05-02,1,230-->

==System logs== help detect unauthorized access or anomalies in services and logins.
<!--SR:!2025-05-02,1,230-->
